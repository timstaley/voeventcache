sudo: required

addons:
  postgresql: "10"
  apt:
    packages:
    - postgresql-10
    packages:
    - postgresql-server-dev-10
    - postgresql-client-10

services:
  - postgresql

env:
  global:
  - PGPORT=5433


language: python


matrix:
  include:
    - python: "2.7"
      env: TOXENV=py27
    - python: "3.5"
      env: TOXENV=py35
    - python: "3.6"
      env: TOXENV=py36


before_install:
  - sudo make -C external/q3c install
  - psql -c "\du" -U postgres | cat
  - psql -l | cat
  - psql -c "create database $USER;" -U postgres | cat
install:
  - cd ${TRAVIS_BUILD_DIR}
  - pip install --upgrade pip
  - pip install tox
  - pip freeze
script:
  - cd ${TRAVIS_BUILD_DIR}
  - tox
